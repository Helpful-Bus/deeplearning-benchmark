--------------------------------------------------------------------------
WARNING: Open MPI tried to bind a process but failed.  This is a
warning only; your job will continue, though performance may
be degraded.

  Local host:        95f3c1a766fc
  Application name:  /usr/bin/python
  Error message:     failed to bind memory
  Location:          rtc_hwloc.c:447

--------------------------------------------------------------------------
2021-02-14 22:00:01.847180: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
WARNING:tensorflow:Deprecation warnings have been disabled. Set TF_ENABLE_DEPRECATION_WARNINGS=1 to re-enable them.
WARNING:tensorflow:From /workspace/nvidia-examples/resnet50v1.5/utils/hooks/training_hooks.py:44: The name tf.train.SessionRunHook is deprecated. Please use tf.estimator.SessionRunHook instead.

WARNING:tensorflow:From /workspace/nvidia-examples/resnet50v1.5/utils/optimizers.py:27: The name tf.train.Optimizer is deprecated. Please use tf.compat.v1.train.Optimizer instead.

WARNING:tensorflow:From ./main.py:36: The name tf.logging.set_verbosity is deprecated. Please use tf.compat.v1.logging.set_verbosity instead.

WARNING:tensorflow:From ./main.py:36: The name tf.logging.ERROR is deprecated. Please use tf.compat.v1.logging.ERROR instead.

DLL 2021-02-14 22:00:03.550310 - PARAMETER arch : resnet50  mode : training_benchmark  data_dir : None  data_idx_dir : None  export_dir : None  to_predict : None  batch_size : 128  num_iter : 100  run_iter : -1  iter_unit : epoch  warmup_steps : 50  data_format : NHWC  model_dir : None  results_dir : output  log_filename : log.json  display_every : 1  lr_init : 0.1  lr_warmup_epochs : 5  weight_decay : 0.0001  weight_init : fan_out  momentum : 0.9  precision : fp32  loss_scale : 128.0  label_smoothing : 0.0  mixup : 0.0  use_static_loss_scaling : True  use_xla : True  use_dali : False  use_tf_amp : True  use_cosine_lr : False  seed : None  gpu_memory_fraction : 0.7  gpu_id : 0  name : False 
Model HParams:
Name resnet50
Number of classes 1001
Compute_format NHWC
Input_format NHWC
dtype <dtype: 'float32'>
Starting Model Training...
Training Epochs 1
Total Steps 100
Steps per Epoch 100
Decay Steps 100
Weight Decay Factor 0.0001
Init Learning Rate 0.1
Momentum 0.9
Num GPUs 1
Per-GPU Batch Size 128
Current step: 0
Using Synthetic Data ...
Using step learning rate schedule
2021-02-14 22:00:08.543763: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3599225000 Hz
2021-02-14 22:00:08.543970: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x65f7cd0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-02-14 22:00:08.543993: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-02-14 22:00:08.548056: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-02-14 22:00:08.760290: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x65fba40 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-02-14 22:00:08.760326: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Quadro RTX 8000, Compute Capability 7.5
2021-02-14 22:00:08.764840: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1665] Found device 0 with properties: 
name: Quadro RTX 8000 major: 7 minor: 5 memoryClockRate(GHz): 1.77
pciBusID: 0000:03:00.0
2021-02-14 22:00:08.764885: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-02-14 22:00:08.768677: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-02-14 22:00:08.770115: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-02-14 22:00:08.770549: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-02-14 22:00:08.775124: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.11
2021-02-14 22:00:08.776050: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-02-14 22:00:08.776215: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-02-14 22:00:08.779990: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1793] Adding visible gpu devices: 0
2021-02-14 22:00:08.780021: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-02-14 22:00:09.130048: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1206] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-02-14 22:00:09.130083: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1212]      0 
2021-02-14 22:00:09.130094: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 0:   N 
2021-02-14 22:00:09.133746: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 47278 MB memory) -> physical GPU (device: 0, name: Quadro RTX 8000, pci bus id: 0000:03:00.0, compute capability: 7.5)
2021-02-14 22:00:09.528610: I tensorflow/core/grappler/optimizers/auto_mixed_precision.cc:1987] Running auto_mixed_precision graph optimizer
2021-02-14 22:00:09.533557: I tensorflow/core/grappler/optimizers/auto_mixed_precision.cc:1343] No whitelist ops found, nothing to do
2021-02-14 22:00:10.291023: I tensorflow/core/grappler/optimizers/auto_mixed_precision.cc:1987] Running auto_mixed_precision graph optimizer
2021-02-14 22:00:10.294208: I tensorflow/core/grappler/optimizers/auto_mixed_precision.cc:1343] No whitelist ops found, nothing to do
2021-02-14 22:00:10.546138: W tensorflow/compiler/jit/mark_for_compilation_pass.cc:1648] (One-time warning): Not using XLA:CPU for cluster because envvar TF_XLA_FLAGS=--tf_xla_cpu_global_jit was not set.  If you want XLA:CPU, either set that envvar, or use experimental_jit_scope to enable XLA:CPU.  To confirm that XLA is active, pass --vmodule=xla_compilation_cache=1 (as a proper command-line flag, not via TF_XLA_FLAGS) or set the envvar XLA_FLAGS=--xla_hlo_profile.
2021-02-14 22:00:10.654113: I tensorflow/core/grappler/optimizers/auto_mixed_precision.cc:1987] Running auto_mixed_precision graph optimizer
2021-02-14 22:00:10.655634: I tensorflow/core/grappler/optimizers/auto_mixed_precision.cc:1343] No whitelist ops found, nothing to do
2021-02-14 22:00:10.807265: I tensorflow/core/grappler/optimizers/auto_mixed_precision.cc:1987] Running auto_mixed_precision graph optimizer
2021-02-14 22:00:10.810519: I tensorflow/core/grappler/optimizers/auto_mixed_precision.cc:1343] No whitelist ops found, nothing to do
2021-02-14 22:00:11.179945: I tensorflow/core/grappler/optimizers/auto_mixed_precision.cc:1987] Running auto_mixed_precision graph optimizer
2021-02-14 22:00:11.180181: I tensorflow/core/grappler/optimizers/auto_mixed_precision.cc:1343] No whitelist ops found, nothing to do
2021-02-14 22:00:14.119674: I tensorflow/core/grappler/optimizers/auto_mixed_precision.cc:1987] Running auto_mixed_precision graph optimizer
2021-02-14 22:00:14.121521: I tensorflow/core/grappler/optimizers/auto_mixed_precision.cc:1343] No whitelist ops found, nothing to do
2021-02-14 22:00:15.059702: I tensorflow/core/grappler/optimizers/auto_mixed_precision.cc:1987] Running auto_mixed_precision graph optimizer
2021-02-14 22:00:15.059984: I tensorflow/core/grappler/optimizers/auto_mixed_precision.cc:1343] No whitelist ops found, nothing to do
2021-02-14 22:00:15.621374: I tensorflow/core/grappler/optimizers/auto_mixed_precision.cc:1987] Running auto_mixed_precision graph optimizer
2021-02-14 22:00:15.621597: I tensorflow/core/grappler/optimizers/auto_mixed_precision.cc:1343] No whitelist ops found, nothing to do
2021-02-14 22:00:15.739033: I tensorflow/core/grappler/optimizers/auto_mixed_precision.cc:1987] Running auto_mixed_precision graph optimizer
2021-02-14 22:00:15.739268: I tensorflow/core/grappler/optimizers/auto_mixed_precision.cc:1343] No whitelist ops found, nothing to do
2021-02-14 22:00:16.234398: I tensorflow/core/grappler/optimizers/auto_mixed_precision.cc:1987] Running auto_mixed_precision graph optimizer
2021-02-14 22:00:16.249171: I tensorflow/core/grappler/optimizers/auto_mixed_precision.cc:1035] Automatic Mixed Precision Grappler Pass Summary:

Total processable nodes: 2372
Recognized nodes available for conversion: 1588
Total nodes converted: 448
Total FP16 Cast ops used (excluding Const and Variable casts): 3
Whitelisted nodes converted: 266
Blacklisted nodes blocking conversion: 62
Nodes blocked from conversion by blacklisted nodes: 8

For more information regarding mixed precision training, including how to make automatic mixed precision aware of a custom op type, please see the documentation available here:
https://docs.nvidia.com/deeplearning/frameworks/tensorflow-user-guide/index.html#tfamp


2021-02-14 22:00:16.943781: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-02-14 22:00:18.201820: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-02-14 22:00:35.865890: I tensorflow/compiler/jit/xla_compilation_cache.cc:241] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2021-02-14 22:00:36.575684: I tensorflow/core/grappler/optimizers/auto_mixed_precision.cc:1987] Running auto_mixed_precision graph optimizer
2021-02-14 22:00:36.591744: I tensorflow/core/grappler/optimizers/auto_mixed_precision.cc:1035] Automatic Mixed Precision Grappler Pass Summary:

Total processable nodes: 2373
Recognized nodes available for conversion: 1588
Total nodes converted: 448
Total FP16 Cast ops used (excluding Const and Variable casts): 3
Whitelisted nodes converted: 266
Blacklisted nodes blocking conversion: 62
Nodes blocked from conversion by blacklisted nodes: 8

For more information regarding mixed precision training, including how to make automatic mixed precision aware of a custom op type, please see the documentation available here:
https://docs.nvidia.com/deeplearning/frameworks/tensorflow-user-guide/index.html#tfamp


DLL 2021-02-14 22:00:53.867130 - (0, 50) total_ips : 943.50095251485 
DLL 2021-02-14 22:00:54.004050 - (0, 51) total_ips : 939.7059290972803 
DLL 2021-02-14 22:00:54.140197 - (0, 52) total_ips : 942.1234145006072 
DLL 2021-02-14 22:00:54.275205 - (0, 53) total_ips : 950.4360523166474 
DLL 2021-02-14 22:00:54.411252 - (0, 54) total_ips : 943.6916743568786 
DLL 2021-02-14 22:00:54.547346 - (0, 55) total_ips : 942.9557477048348 
DLL 2021-02-14 22:00:54.683553 - (0, 56) total_ips : 942.7338691409577 
DLL 2021-02-14 22:00:54.820253 - (0, 57) total_ips : 939.1191008877422 
DLL 2021-02-14 22:00:54.955394 - (0, 58) total_ips : 950.5353349539402 
DLL 2021-02-14 22:00:55.091925 - (0, 59) total_ips : 941.360219107369 
DLL 2021-02-14 22:00:55.227852 - (0, 60) total_ips : 944.8160104746686 
DLL 2021-02-14 22:00:55.362653 - (0, 61) total_ips : 951.8278993408293 
DLL 2021-02-14 22:00:55.499287 - (0, 62) total_ips : 938.9630655683229 
DLL 2021-02-14 22:00:55.635224 - (0, 63) total_ips : 944.8825247981302 
DLL 2021-02-14 22:00:55.771646 - (0, 64) total_ips : 940.8009981547456 
DLL 2021-02-14 22:00:55.907850 - (0, 65) total_ips : 942.4591494060378 
DLL 2021-02-14 22:00:56.044014 - (0, 66) total_ips : 942.6577259454742 
DLL 2021-02-14 22:00:56.179283 - (0, 67) total_ips : 948.3810264056019 
DLL 2021-02-14 22:00:56.316090 - (0, 68) total_ips : 938.7397789147168 
DLL 2021-02-14 22:00:56.451799 - (0, 69) total_ips : 946.0430420922975 
DLL 2021-02-14 22:00:56.587689 - (0, 70) total_ips : 944.2593204271119 
DLL 2021-02-14 22:00:56.722867 - (0, 71) total_ips : 949.6828534837153 
DLL 2021-02-14 22:00:56.859129 - (0, 72) total_ips : 941.328858754447 
DLL 2021-02-14 22:00:56.994260 - (0, 73) total_ips : 949.4477236071418 
DLL 2021-02-14 22:00:57.130723 - (0, 74) total_ips : 940.7630809776475 
DLL 2021-02-14 22:00:57.266680 - (0, 75) total_ips : 944.2559988743591 
DLL 2021-02-14 22:00:57.403284 - (0, 76) total_ips : 940.9559957865882 
DLL 2021-02-14 22:00:57.539761 - (0, 77) total_ips : 940.8801395010559 
DLL 2021-02-14 22:00:57.675055 - (0, 78) total_ips : 947.7398155258396 
DLL 2021-02-14 22:00:57.812270 - (0, 79) total_ips : 935.7781759616256 
DLL 2021-02-14 22:00:57.948177 - (0, 80) total_ips : 944.8742099955473 
DLL 2021-02-14 22:00:58.084518 - (0, 81) total_ips : 941.1638386979715 
DLL 2021-02-14 22:00:58.221503 - (0, 82) total_ips : 937.3253650249926 
DLL 2021-02-14 22:00:58.356585 - (0, 83) total_ips : 949.9634821967304 
DLL 2021-02-14 22:00:58.492992 - (0, 84) total_ips : 941.0582562222063 
DLL 2021-02-14 22:00:58.628519 - (0, 85) total_ips : 946.6852969286165 
DLL 2021-02-14 22:00:58.764804 - (0, 86) total_ips : 941.6194346469481 
DLL 2021-02-14 22:00:58.900749 - (0, 87) total_ips : 944.3805730971521 
DLL 2021-02-14 22:00:59.036664 - (0, 88) total_ips : 944.5151501823511 
DLL 2021-02-14 22:00:59.171741 - (0, 89) total_ips : 949.5871079800415 
DLL 2021-02-14 22:00:59.308230 - (0, 90) total_ips : 941.4493599410795 
DLL 2021-02-14 22:00:59.444918 - (0, 91) total_ips : 939.2571121658668 
DLL 2021-02-14 22:00:59.580491 - (0, 92) total_ips : 946.0630472669474 
DLL 2021-02-14 22:00:59.716238 - (0, 93) total_ips : 945.0588330557913 
DLL 2021-02-14 22:00:59.851500 - (0, 94) total_ips : 949.2362062441874 
DLL 2021-02-14 22:00:59.987919 - (0, 95) total_ips : 941.0120713378029 
DLL 2021-02-14 22:01:00.123679 - (0, 96) total_ips : 944.4586563648422 
DLL 2021-02-14 22:01:00.259711 - (0, 97) total_ips : 944.7877447227868 
DLL 2021-02-14 22:01:00.395072 - (0, 98) total_ips : 948.3692993628323 
DLL 2021-02-14 22:01:00.532053 - (0, 99) total_ips : 937.1257569066366 
Ending Model Training ...
DLL 2021-02-14 22:01:01.386864 - () train_throughput : 943.7763256184564 
DONE!
